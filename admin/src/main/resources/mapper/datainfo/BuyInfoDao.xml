<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.base.modules.business.system.datainfo.dao.BuyInfoDao">

	<!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="com.base.modules.business.system.datainfo.entity.BuyInfoEntity" id="buyInfoMap">
        <result property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="phone" column="phone"/>
        <result property="proType" column="pro_type"/>
        <result property="buyTime" column="buy_time"/>
        <result property="buyPrice" column="buy_price"/>
        <result property="buyNumber" column="buy_number"/>
        <result property="buyChannel" column="buy_channel"/>
        <result property="buyAddress" column="buy_address"/>
        <result property="address" column="address"/>
        <result property="remark" column="remark"/>
        <result property="star" column="star"/>
        <result property="returnInfo" column="return_info"/>
        <result property="createDate" column="create_date"/>
        <result property="updateDate" column="update_date"/>
    </resultMap>
	<select id="queryBuyInfoByType" resultType="java.util.Map">
		 <if test="type=='1'">
		  	SELECT
				t.address x,
				count(1) number
			FROM
				biz_buy_info t
			GROUP BY
				t.address
		 </if>
		 <if test="type=='2'">
		 	SELECT
				t.pro_type x,
				count(1) number
			FROM
				biz_buy_info t
			GROUP BY
				t.pro_type
		 </if>
		 <if test="type=='3'">
		 	SELECT
				t.buy_time x,
				count(1) number
			FROM
				biz_buy_info t
			GROUP BY
				t.buy_time	
		 </if>
		 <if test="type == '4'">
		 	SELECT
				'已拜访' x,
				count(1) number
			FROM
				biz_buy_info t
			where (t.return_info is not null and t.return_info <> '')
			UNION
			select 
				'未拜访' x,
				count(1) number
			FROM
				biz_buy_info t1
			where t1.return_info is null or t1.return_info =''
		 </if>
	</select>

</mapper>